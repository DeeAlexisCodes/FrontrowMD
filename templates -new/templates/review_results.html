<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Results - FrontrowMD</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --background-color: #F8F9FA;
            --text-primary: #121212;
            --text-secondary: #555;
            --accent-primary: #FF6B00;
            --border-subtle: #E0E0E0;
            --card-bg: #FFFFFF;
            --code-bg: #2d333b;
            --code-text: #cdd9e5;
            --success-color: #10B981;
            --danger-color: #EF4444;
            --info-color: #3B82F6;
            --warning-color: #F59E0B;

            --font-family-sans: 'Inter', sans-serif;
            --font-family-mono: 'Menlo', 'Consolas', monospace;
            --font-weight-regular: 400;
            --font-weight-medium: 500;
            --font-weight-bold: 700;

            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 32px;
            --spacing-xl: 48px;

            --border-radius-medium: 12px;
            --border-radius-large: 16px;
            --border-radius-full: 50%;
            
            --shadow-soft: 0px 4px 12px rgba(0, 0, 0, 0.05);
            --shadow-medium: 0px 8px 24px rgba(0, 0, 0, 0.1);
        }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        body {
            font-family: var(--font-family-sans);
            background-color: var(--background-color);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--spacing-lg);
        }

        /* Header & Footer */
        .header { padding: var(--spacing-md) 0; }
        .header__container { display: flex; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: var(--font-weight-bold); text-decoration: none; color: var(--text-primary); display: flex; align-items: center; gap: 8px; }
        .logo__icon { color: var(--accent-primary); }
        .footer { padding: var(--spacing-xl) 0; text-align: center; font-size: 0.9rem; color: #aaa; }

        /* Main Content */
        .main-content { padding: var(--spacing-xl) 0; }
        
        .page-header {
            text-align: center;
            margin-bottom: var(--spacing-lg);
            animation: fadeIn 0.5s ease-out;
        }

        .page-title { font-size: 2rem; font-weight: var(--font-weight-bold); margin-bottom: var(--spacing-md); }

        /* Tabs */
        .tabs-container {
            display: flex;
            justify-content: center;
            margin-bottom: var(--spacing-xl);
            animation: fadeIn 0.5s ease-out 0.1s backwards;
        }

        .tabs {
            display: flex;
            background: var(--card-bg);
            border-radius: var(--border-radius-large);
            padding: 4px;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--border-subtle);
        }

        .tab-button {
            background: transparent;
            border: none;
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: var(--border-radius-medium);
            cursor: pointer;
            font-weight: var(--font-weight-medium);
            transition: all 0.3s ease;
            color: var(--text-secondary);
            position: relative;
        }

        .tab-button.active {
            background: var(--accent-primary);
            color: white;
            box-shadow: var(--shadow-soft);
        }

        .tab-button:not(.active):hover {
            background: var(--background-color);
            color: var(--text-primary);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        /* Pending Review View */
        .pending-review-container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: var(--border-radius-large);
            box-shadow: var(--shadow-soft);
            padding: var(--spacing-xl);
        }

        .pending-review-navigation {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--border-subtle);
        }

        .review-counter {
            font-weight: var(--font-weight-medium);
            color: var(--text-secondary);
        }

        .nav-buttons {
            display: flex;
            gap: var(--spacing-sm);
        }

        .nav-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-subtle);
            border-radius: var(--border-radius-full);
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .nav-btn:hover {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .nav-btn:disabled:hover {
            background: var(--card-bg);
            color: inherit;
            border-color: var(--border-subtle);
        }

        /* Review Content */
        .review-content-container {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .doctor-info {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .doctor-info img {
            width: 80px;
            height: 80px;
            border-radius: var(--border-radius-full);
            object-fit: cover;
            box-shadow: var(--shadow-soft);
        }

        .doctor-details h3 {
            font-weight: var(--font-weight-bold);
            margin-bottom: 4px;
        }

        .doctor-details .title {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .review-header {
            text-align: center;
        }

        .review-title {
            font-size: 1.5rem;
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--spacing-sm);
        }

        .review-summary {
            font-style: italic;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-md);
        }

        .review-tags {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm);
            justify-content: center;
            margin-bottom: var(--spacing-md);
        }

        .tag {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: var(--font-weight-medium);
            border: 1px solid;
        }

        .tag.highlight {
            background: var(--info-color);
            color: white;
            border-color: var(--info-color);
        }

        .tag.tone {
            background: var(--warning-color);
            color: white;
            border-color: var(--warning-color);
        }

        .tag.research {
            background: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .word-count-display {
            text-align: center;
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-lg);
        }

        .review-text {
            background: var(--background-color);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius-medium);
            margin-bottom: var(--spacing-lg);
        }

        .review-text p {
            margin-bottom: 1em;
        }

        .review-text p:last-child {
            margin-bottom: 0;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-sm);
            border-bottom: 1px solid var(--border-subtle);
        }

        .studies-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .study-item {
            background: var(--card-bg);
            border: 1px solid var(--border-subtle);
            border-radius: var(--border-radius-medium);
            padding: var(--spacing-md);
        }

        .study-link {
            color: var(--accent-primary);
            text-decoration: none;
            font-weight: var(--font-weight-medium);
            word-break: break-all;
        }

        .study-link:hover {
            text-decoration: underline;
        }

        .pending-actions {
            display: flex;
            gap: var(--spacing-md);
            justify-content: center;
            margin-top: var(--spacing-xl);
            padding-top: var(--spacing-lg);
            border-top: 1px solid var(--border-subtle);
        }

        .action-btn {
            padding: var(--spacing-md) var(--spacing-lg);
            border: none;
            border-radius: var(--border-radius-medium);
            cursor: pointer;
            font-weight: var(--font-weight-medium);
            transition: all 0.2s ease;
            min-width: 120px;
        }

        .action-btn.accept {
            background: var(--success-color);
            color: white;
        }

        .action-btn.accept:hover {
            background: #059669;
            transform: translateY(-1px);
        }

        .action-btn.reject {
            background: var(--danger-color);
            color: white;
        }

        .action-btn.reject:hover {
            background: #DC2626;
            transform: translateY(-1px);
        }

        .action-btn.edit {
            background: var(--card-bg);
            color: var(--text-primary);
            border: 1px solid var(--border-subtle);
        }

        .action-btn.edit:hover {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
            transform: translateY(-1px);
        }

        /* Accepted Reviews Carousel */
        .carousel-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-md);
            animation: fadeIn 0.5s ease-out 0.2s backwards;
        }

        .carousel-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-subtle);
            border-radius: var(--border-radius-full);
            width: 44px;
            height: 44px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-soft);
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .carousel-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-medium);
        }

        .carousel-btn svg { width: 24px; height: 24px; color: var(--text-secondary); }

        .carousel-viewport {
            width: 100%;
            max-width: 800px;
            overflow: hidden;
        }

        .carousel-track {
            display: flex;
            align-items: center;
            transition: transform 0.4s ease-out;
        }

        .review-card {
            background: var(--card-bg);
            border-radius: var(--border-radius-large);
            box-shadow: var(--shadow-soft);
            padding: var(--spacing-lg);
            text-align: center;
            flex: 0 0 80%;
            margin: 0 10px;
            max-width: 400px;
            cursor: pointer;
            transition: transform 0.4s ease, opacity 0.4s ease;
            transform: scale(0.85);
            opacity: 0.6;
            position: relative;
        }

        @media (min-width: 768px) {
            .review-card {
                flex-basis: 60%;
            }
        }

        .review-card.is-active {
            transform: scale(1);
            opacity: 1;
        }

        .card-doctor-info { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: var(--spacing-sm); 
            margin-bottom: var(--spacing-md); 
        }

        .card-doctor-info img { 
            width: 60px; 
            height: 60px; 
            border-radius: var(--border-radius-full); 
            object-fit: cover; 
            box-shadow: var(--shadow-soft); 
        }

        .card-doctor-info .name { 
            font-weight: var(--font-weight-bold); 
            font-size: 0.9rem;
        }
        
        .review-card__title { 
            font-size: 1.1rem; 
            font-weight: var(--font-weight-bold); 
            margin-bottom: var(--spacing-sm); 
        }

        .review-card__summary { 
            color: var(--text-secondary); 
            font-size: 0.85rem;
            font-style: italic;
            margin-bottom: var(--spacing-sm);
        }

        .card-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            justify-content: center;
            margin-bottom: var(--spacing-sm);
        }

        .card-tags .tag {
            font-size: 0.75rem;
            padding: 2px 8px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: var(--spacing-xl) var(--spacing-lg);
            background: var(--card-bg);
            border-radius: var(--border-radius-large);
            box-shadow: var(--shadow-soft);
            max-width: 500px;
            margin: 0 auto;
        }

        .empty-state-icon {
            width: 64px;
            height: 64px;
            background: var(--background-color);
            border-radius: var(--border-radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--spacing-md);
        }

        .empty-state-title {
            font-size: 1.25rem;
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--spacing-sm);
        }

        .empty-state-message {
            color: var(--text-secondary);
        }

        /* Modal styles remain the same as before */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }
        .modal.is-visible { display: flex; }
        
        .modal-content {
            background: var(--background-color);
            border-radius: var(--border-radius-large);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-content.small {
            max-width: 500px;
            max-height: 400px;
        }
        
        .modal-body {
             padding: var(--spacing-xl);
        }

        .modal-close {
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-md);
            background: var(--border-subtle);
            border: none;
            border-radius: var(--border-radius-full);
            width: 32px;
            height: 32px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        
        .modal-close:hover {
            background: var(--text-secondary);
            color: white;
        }

        /* Success Modal Styles */
        .success-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 64px;
            height: 64px;
            background: var(--success-color);
            border-radius: var(--border-radius-full);
            margin: 0 auto var(--spacing-md);
        }

        .success-icon svg {
            width: 32px;
            height: 32px;
            color: white;
        }

        .success-title {
            font-size: 1.5rem;
            font-weight: var(--font-weight-bold);
            text-align: center;
            margin-bottom: var(--spacing-sm);
            color: var(--success-color);
        }

        .success-message {
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-lg);
        }

        /* Reject Modal Styles */
        .reject-form {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .reject-title {
            font-size: 1.5rem;
            font-weight: var(--font-weight-bold);
            text-align: center;
            margin-bottom: var(--spacing-md);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .form-label {
            font-weight: var(--font-weight-medium);
            color: var(--text-primary);
        }
 
        .form-textarea {
            padding: var(--spacing-md);
            border: 1px solid var(--border-subtle);
            border-radius: var(--border-radius-medium);
            font-family: var(--font-family-sans);
            font-size: 1rem;
            resize: vertical;
            min-height: 120px;
        }

        .form-textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 0, 0.1);
        }

        .form-submit {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: var(--border-radius-medium);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .form-submit:hover {
            background: #DC2626;
            transform: translateY(-1px);
        }

        .form-submit:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Edit Modal Styles */
        .edit-form {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .edit-title {
            font-size: 1.5rem;
            font-weight: var(--font-weight-bold);
            text-align: center;
            margin-bottom: var(--spacing-md);
        }

        .form-row {
            display: flex;
            gap: var(--spacing-md);
            align-items: flex-end;
        }

        .form-row .form-group {
            flex: 1;
        }

        .form-input {
            padding: var(--spacing-md);
            border: 1px solid var(--border-subtle);
            border-radius: var(--border-radius-medium);
            font-family: var(--font-family-sans);
            font-size: 1rem;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 0, 0.1);
        }

        .word-count-options {
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }

        .word-count-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-subtle);
            border-radius: var(--border-radius-medium);
            padding: var(--spacing-sm) var(--spacing-md);
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .word-count-btn:hover,
        .word-count-btn.active {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .current-review-preview {
            background: var(--card-bg);
            border: 1px solid var(--border-subtle);
            border-radius: var(--border-radius-medium);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            max-height: 200px;
            overflow-y: auto;
        }

        .preview-title {
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--spacing-sm);
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .form-submit.primary {
            background: var(--accent-primary);
            color: white;
        }

        .form-submit.primary:hover {
            background: #E55A00;
        }

        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: var(--spacing-sm);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .current-review-preview.editing {
            overflow: hidden;
        }

        .review-content {
            transition: opacity 0.3s ease;
        }

        .review-content.fade-out {
            opacity: 0.3;
        }

        .editing-animation {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--card-bg);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2;
        }

        .editing-animation.active {
            display: flex;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
            margin-bottom: var(--spacing-md);
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-primary);
            border-radius: 50%;
            animation: typingPulse 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        .typing-dot:nth-child(3) { animation-delay: 0s; }

        @keyframes typingPulse {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .editing-text {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-align: center;
            font-weight: var(--font-weight-medium);
        }

        .progress-bar {
            width: 200px;
            height: 4px;
            background: var(--border-subtle);
            border-radius: 2px;
            margin-top: var(--spacing-md);
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent-primary);
            width: 0%;
            border-radius: 2px;
            transition: width 0.1s ease;
        }

    </style>
</head>
<body>

    <header class="header">
        <div class="container header__container">
            <a href="/" class="logo"><span class="logo__icon">+</span><span>FrontrowMD</span></a>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <header class="page-header">
                <h1 class="page-title">Generated Review Templates</h1>
                
                <div class="tabs-container">
                    <div class="tabs">
                        <button class="tab-button active" data-tab="pending">Pending Reviews</button>
                        <button class="tab-button" data-tab="accepted">Accepted Reviews</button>
                    </div>
                </div>
            </header>

            <!-- Pending Reviews Tab -->
            <div class="tab-content active" id="pending-tab">
                <div id="pending-content">
                    <!-- Content will be populated by JS -->
                </div>
            </div>

            <!-- Accepted Reviews Tab -->
            <div class="tab-content" id="accepted-tab">
                <div id="accepted-content">
                    <!-- Content will be populated by JS -->
                </div>
            </div>
        </div>
    </main>
    
    <!-- Accept Success Modal -->
    <div class="modal" id="accept-modal">
        <div class="modal-content small">
            <button class="modal-close" id="accept-modal-close-btn">
                <svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
            </button>
            <div class="modal-body">
                <div class="success-icon">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z" /></svg>
                </div>
                <h2 class="success-title">Review Accepted!</h2>
                <p class="success-message">The review has been successfully saved to the product.</p>
            </div>
        </div>
    </div>

    <!-- Reject Reason Modal -->
    <div class="modal" id="reject-modal">
        <div class="modal-content small">
            <button class="modal-close" id="reject-modal-close-btn">
                <svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
            </button>
            <div class="modal-body">
                <h2 class="reject-title">Reject Review</h2>
                <form class="reject-form" id="reject-form">
                    <div class="form-group">
                        <label class="form-label" for="reject-reason">Reason for rejection:</label>
                        <textarea 
                            class="form-textarea" 
                            id="reject-reason" 
                            name="reject-reason" 
                            placeholder="Please provide a reason for rejecting this review..."
                            required
                        ></textarea>
                    </div>
                    <button type="submit" class="form-submit">Submit Rejection</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Reject Success Modal -->
    <div class="modal" id="reject-success-modal">
        <div class="modal-content small">
            <button class="modal-close" id="reject-success-modal-close-btn">
                <svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
            </button>
            <div class="modal-body">
                <div class="success-icon">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z" /></svg>
                </div>
                <h2 class="success-title">Rejection Captured</h2>
                <p class="success-message">Your rejection has been captured and saved.</p>
            </div>
        </div>
    </div>

    <!-- Edit Review Modal -->
    <div class="modal" id="edit-modal">
        <div class="modal-content">
            <button class="modal-close" id="edit-modal-close-btn">
                <svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
            </button>
            <div class="modal-body">
                <h2 class="edit-title">Edit Review</h2>
                
                <div class="current-review-preview" id="current-review-preview">
                    <div class="preview-title">Current Review:</div>
                    <div id="current-review-content" class="review-content"></div>
                    <div class="editing-animation" id="editing-animation">
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                        <div class="editing-text">Generating your edited review...</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                    </div>
                </div>

                <form class="edit-form" id="edit-form">
                    <div class="form-group">
                        <label class="form-label">Target Word Count:</label>
                        <div class="word-count-options">
                            <button type="button" class="word-count-btn" data-count="50">50 words</button>
                            <button type="button" class="word-count-btn" data-count="75">75 words</button>
                            <button type="button" class="word-count-btn active" data-count="100">100 words</button>
                            <button type="button" class="word-count-btn" data-count="150">150 words</button>
                            <button type="button" class="word-count-btn" data-count="200">200 words</button>
                        </div>
                        <input type="hidden" id="selected-word-count" name="word-count" value="100">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="tone-adjustment">Tone Adjustment:</label>
                        <input 
                            type="text" 
                            class="form-input" 
                            id="tone-adjustment" 
                            name="tone-adjustment" 
                            placeholder="e.g., make this more formal, casual, scientific, warm, professional..."
                        />
                    </div>

                    <div class="form-row">
                        <button type="button" class="form-submit" id="cancel-edit-btn">Cancel</button>
                        <button type="submit" class="form-submit primary" id="generate-edit-btn">
                            <span id="generate-btn-text">Generate Edited Review</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Edit Success Modal -->
    <div class="modal" id="edit-success-modal">
        <div class="modal-content">
            <button class="modal-close" id="edit-success-modal-close-btn">
                <svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
            </button>
            <div class="modal-body">
                <div class="success-icon">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z" /></svg>
                </div>
                <h2 class="success-title">Review Updated!</h2>
                <div id="updated-review-content" class="current-review-preview">
                    <!-- Updated review content will be shown here -->
                </div>
                <div style="display: flex; gap: var(--spacing-md); justify-content: center; margin-top: var(--spacing-lg);">
                    <button class="form-submit" id="keep-original-btn">Keep Original</button>
                    <button class="form-submit primary" id="use-updated-btn">Use Updated Version</button>
                </div>
            </div>
        </div>
    </div>
    
    <footer class="footer">
        <div class="container"><p>&copy; 2024 FrontrowMD. All rights reserved.</p></div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Sample data with new metadata format
            const pendingReviewsData = [
                {
                    reviewer_name: 'Dr. Marcus Thorne',
                    reviewer_title: 'MD, Urologist & Male Fertility Specialist',
                    review_title: 'Evidence-Based Male Fertility Support',
                    review_summary_line: 'Clinical data supports this formulation for improving key sperm parameters.',
                    review_text: 'Clinical evidence strongly supports the use of antioxidant supplementation for male factor infertility. Research demonstrates that key ingredients like Coenzyme Q10, zinc, and folic acid significantly improve sperm parameters. A 2009 randomized controlled trial showed CoQ10 improved sperm density and motility. Furthermore, a comprehensive 2024 review confirmed that combining these antioxidants can increase total sperm count and reduce DNA damage. This formulation aligns with current data, offering a scientifically validated approach to enhancing male reproductive health and supporting conception.',
                    highlights: ['Research Backed', 'Clinically Proven', 'Antioxidant Formula'],
                    tone_type: 'clinical_authority',
                    uses_clinical_research: true,
                    target_word_count: 80,
                    actual_word_count: 79,
                    profile_image_url: 'https://images.pexels.com/photos/1486064/pexels-photo-1486064.jpeg',
                    referenced_studies: [
                        'https://pmc.ncbi.nlm.nih.gov/articles/PMC10869131/?utm_source=chatgpt.com',
                        'https://pubmed.ncbi.nlm.nih.gov/19447425/'
                    ]
                },
                {
                    reviewer_name: 'Dr. Sarah Chen',
                    reviewer_title: 'MD, Dermatologist',
                    review_title: 'Advanced Skin Barrier Protection',
                    review_summary_line: 'Innovative ceramide complex shows promising results for compromised skin barriers.',
                    review_text: 'The skin barrier function is critical for maintaining healthy skin hydration and protection against environmental stressors. This ceramide-rich formulation addresses barrier dysfunction through a multi-layered approach. Clinical studies demonstrate that topical ceramides can restore barrier integrity within 2-4 weeks of consistent use. The inclusion of cholesterol and fatty acids creates a biomimetic lipid profile that closely resembles the skin\'s natural composition. For patients with compromised barriers due to age, environmental damage, or genetic predisposition, this represents an evidence-based therapeutic option.',
                    highlights: ['Barrier Repair', 'Clinically Tested', 'Biomimetic'],
                    tone_type: 'scientific_precision',
                    uses_clinical_research: true,
                    target_word_count: 85,
                    actual_word_count: 87,
                    profile_image_url: 'https://images.pexels.com/photos/5327921/pexels-photo-5327921.jpeg',
                    referenced_studies: [
                        'https://pubmed.ncbi.nlm.nih.gov/ceramide-barrier-function-2023/',
                        'https://pubmed.ncbi.nlm.nih.gov/lipid-composition-skin-2022/'
                    ]
                }
            ];

            const acceptedReviewsData = [
                {
                    reviewer_name: 'Dr. Jennifer Walsh',
                    reviewer_title: 'MD, Internal Medicine',
                    review_title: 'Comprehensive Wellness Support',
                    review_summary_line: 'Well-rounded formulation addresses multiple health markers effectively.',
                    review_text: 'As an internist, I appreciate supplements that address multiple health parameters simultaneously. This formulation combines evidence-based ingredients in clinically relevant dosages. The B-vitamin complex supports energy metabolism, while the antioxidant blend provides cellular protection. Patient compliance improves when they can consolidate their supplement regimen, and this product allows for that simplification without compromising efficacy.',
                    highlights: ['Multi-Target', 'Evidence-Based', 'Patient-Friendly'],
                    tone_type: 'approachable_authority',
                    uses_clinical_research: true,
                    target_word_count: 70,
                    actual_word_count: 68,
                    profile_image_url: 'https://images.pexels.com/photos/5407206/pexels-photo-5407206.jpeg',
                    referenced_studies: [
                        'https://pubmed.ncbi.nlm.nih.gov/b-vitamin-metabolism-2023/'
                    ]
                }
            ];

            let currentPendingIndex = 0;
            let currentAcceptedIndex = 0;
            let currentEditingIndex = -1;
            let updatedReviewData = null;

            // Tab switching functionality
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.dataset.tab;
                    
                    // Update active states
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    button.classList.add('active');
                    document.getElementById(`${targetTab}-tab`).classList.add('active');
                    
                    // Render appropriate content
                    if (targetTab === 'pending') {
                        renderPendingReviews();
                    } else {
                        renderAcceptedReviews();
                    }
                });
            });

            function renderPendingReviews() {
                const pendingContent = document.getElementById('pending-content');
                
                if (pendingReviewsData.length === 0) {
                    pendingContent.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                                    <path fill="currentColor" d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z"/>
                                </svg>
                            </div>
                            <h3 class="empty-state-title">No Pending Reviews</h3>
                            <p class="empty-state-message">No reviews were generated for this product.</p>
                        </div>
                    `;
                    return;
                }

                const review = pendingReviewsData[currentPendingIndex];
                const toneTypeFormatted = review.tone_type.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                
                const highlightTags = review.highlights.map(highlight => 
                    `<span class="tag highlight">${highlight}</span>`
                ).join('');
                
                const toneTag = `<span class="tag tone">${toneTypeFormatted}</span>`;
                const researchTag = review.uses_clinical_research ? `<span class="tag research">Clinical Research</span>` : '';
                
                const studiesList = review.referenced_studies.map(url => 
                    `<li class="study-item">
                        <a href="${url}" target="_blank" class="study-link">${url}</a>
                    </li>`
                ).join('');

                pendingContent.innerHTML = `
                    <div class="pending-review-container">
                        <div class="pending-review-navigation">
                            <div class="review-counter">
                                Review ${currentPendingIndex + 1} of ${pendingReviewsData.length}
                            </div>
                            <div class="nav-buttons">
                                <button class="nav-btn" id="prev-pending-btn" ${currentPendingIndex === 0 ? 'disabled' : ''}>
                                    <svg width="20" height="20" viewBox="0 0 24 24">
                                        <path fill="currentColor" d="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z" />
                                    </svg>
                                </button>
                                <button class="nav-btn" id="next-pending-btn" ${currentPendingIndex === pendingReviewsData.length - 1 ? 'disabled' : ''}>
                                    <svg width="20" height="
                                    <svg width="20" height="20" viewBox="0 0 24 24">
                                        <path fill="currentColor" d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" />
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="review-content-container">
                            <div class="doctor-info">
                                <img src="${review.profile_image_url}" alt="${review.reviewer_name}">
                                <div class="doctor-details">
                                    <h3>${review.reviewer_name}</h3>
                                    <div class="title">${review.reviewer_title}</div>
                                </div>
                            </div>

                            <div class="review-header">
                                <h2 class="review-title">${review.review_title}</h2>
                                <p class="review-summary">${review.review_summary_line}</p>
                                
                                <div class="review-tags">
                                    ${highlightTags}
                                    ${toneTag}
                                    ${researchTag}
                                </div>
                                
                                <div class="word-count-display">
                                    ${review.actual_word_count}/${review.target_word_count} words
                                </div>
                            </div>

                            <div class="review-text">
                                ${review.review_text}
                            </div>

                            <div class="referenced-studies-section">
                                <h3 class="section-title">Referenced Clinical Studies</h3>
                                <ul class="studies-list">
                                    ${studiesList}
                                </ul>
                            </div>

                            <div class="pending-actions">
                                <button class="action-btn accept" onclick="acceptPendingReview(${currentPendingIndex})">Accept</button>
                                <button class="action-btn edit" onclick="editPendingReview(${currentPendingIndex})">Edit</button>
                                <button class="action-btn reject" onclick="rejectPendingReview(${currentPendingIndex})">Reject</button>
                            </div>
                        </div>
                    </div>
                `;

                // Add navigation event listeners
                const prevBtn = document.getElementById('prev-pending-btn');
                const nextBtn = document.getElementById('next-pending-btn');
                
                if (prevBtn && !prevBtn.disabled) {
                    prevBtn.addEventListener('click', () => {
                        currentPendingIndex = Math.max(0, currentPendingIndex - 1);
                        renderPendingReviews();
                    });
                }
                
                if (nextBtn && !nextBtn.disabled) {
                    nextBtn.addEventListener('click', () => {
                        currentPendingIndex = Math.min(pendingReviewsData.length - 1, currentPendingIndex + 1);
                        renderPendingReviews();
                    });
                }
            }

            function renderAcceptedReviews() {
                const acceptedContent = document.getElementById('accepted-content');
                
                if (acceptedReviewsData.length === 0) {
                    acceptedContent.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                                    <path fill="currentColor" d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"/>
                                </svg>
                            </div>
                            <h3 class="empty-state-title">No Accepted Reviews</h3>
                            <p class="empty-state-message">Yet to accept reviews for this product.</p>
                        </div>
                    `;
                    return;
                }

                acceptedContent.innerHTML = `
                    <div class="carousel-container">
                        <button id="prev-accepted-btn" class="carousel-btn">
                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z" /></svg>
                        </button>
                        <div class="carousel-viewport" id="accepted-carousel-viewport">
                            <div class="carousel-track" id="accepted-carousel-track">
                                <!-- Review cards will be populated by JS -->
                            </div>
                        </div>
                        <button id="next-accepted-btn" class="carousel-btn">
                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
                        </button>
                    </div>
                `;

                const track = document.getElementById('accepted-carousel-track');
                const viewport = document.getElementById('accepted-carousel-viewport');
                
                track.innerHTML = '';
                acceptedReviewsData.forEach((review, index) => {
                    const card = document.createElement('div');
                    card.className = 'review-card';
                    card.dataset.index = index;
                    
                    const toneTypeFormatted = review.tone_type.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                    const highlightTags = review.highlights.slice(0, 2).map(highlight => 
                        `<span class="tag highlight">${highlight}</span>`
                    ).join('');
                    const toneTag = `<span class="tag tone">${toneTypeFormatted}</span>`;

                    card.innerHTML = `
                        <div class="card-doctor-info">
                            <img src="${review.profile_image_url}" alt="${review.reviewer_name}">
                            <span class="name">${review.reviewer_name}</span>
                        </div>
                        <h2 class="review-card__title">${review.review_title}</h2>
                        <p class="review-card__summary">${review.review_summary_line}</p>
                        <div class="card-tags">
                            ${highlightTags}
                            ${toneTag}
                        </div>
                    `;
                    
                    card.addEventListener('click', () => openAcceptedReviewModal(index));
                    track.appendChild(card);
                });

                updateAcceptedCarousel();

                // Add carousel navigation
                const prevBtn = document.getElementById('prev-accepted-btn');
                const nextBtn = document.getElementById('next-accepted-btn');
                
                prevBtn.addEventListener('click', () => {
                    currentAcceptedIndex = (currentAcceptedIndex - 1 + acceptedReviewsData.length) % acceptedReviewsData.length;
                    updateAcceptedCarousel();
                });
                
                nextBtn.addEventListener('click', () => {
                    currentAcceptedIndex = (currentAcceptedIndex + 1) % acceptedReviewsData.length;
                    updateAcceptedCarousel();
                });
            }

            function updateAcceptedCarousel() {
                const cards = document.querySelectorAll('#accepted-carousel-track .review-card');
                const track = document.getElementById('accepted-carousel-track');
                const viewport = document.getElementById('accepted-carousel-viewport');
                
                if (cards.length === 0) return;

                const cardWidth = cards[0].offsetWidth;
                const gap = 20;
                const offset = -currentAcceptedIndex * (cardWidth + gap) + (viewport.offsetWidth / 2 - cardWidth / 2);
                
                track.style.transform = `translateX(${offset}px)`;

                cards.forEach((card, index) => {
                    card.classList.toggle('is-active', index === currentAcceptedIndex);
                });
            }

            function openAcceptedReviewModal(index) {
                const review = acceptedReviewsData[index];
                
                // Create modal content similar to the detailed view
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.style.display = 'flex';
                
                const toneTypeFormatted = review.tone_type.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                const highlightTags = review.highlights.map(highlight => 
                    `<span class="tag highlight">${highlight}</span>`
                ).join('');
                const toneTag = `<span class="tag tone">${toneTypeFormatted}</span>`;
                const researchTag = review.uses_clinical_research ? `<span class="tag research">Clinical Research</span>` : '';
                
                const studiesList = review.referenced_studies.map(url => 
                    `<li class="study-item">
                        <a href="${url}" target="_blank" class="study-link">${url}</a>
                    </li>`
                ).join('');

                modal.innerHTML = `
                    <div class="modal-content">
                        <button class="modal-close">
                            <svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
                        </button>
                        <div class="modal-body">
                            <div class="doctor-info">
                                <img src="${review.profile_image_url}" alt="${review.reviewer_name}">
                                <div class="doctor-details">
                                    <h3>${review.reviewer_name}</h3>
                                    <div class="title">${review.reviewer_title}</div>
                                </div>
                            </div>

                            <div class="review-header">
                                <h2 class="review-title">${review.review_title}</h2>
                                <p class="review-summary">${review.review_summary_line}</p>
                                
                                <div class="review-tags">
                                    ${highlightTags}
                                    ${toneTag}
                                    ${researchTag}
                                </div>
                                
                                <div class="word-count-display">
                                    ${review.actual_word_count}/${review.target_word_count} words
                                </div>
                            </div>

                            <div class="review-text">
                                ${review.review_text}
                            </div>

                            <div class="referenced-studies-section">
                                <h3 class="section-title">Referenced Clinical Studies</h3>
                                <ul class="studies-list">
                                    ${studiesList}
                                </ul>
                            </div>
                        </div>
                    </div>
                `;

                document.body.appendChild(modal);
                
                // Add close functionality
                const closeBtn = modal.querySelector('.modal-close');
                closeBtn.addEventListener('click', () => {
                    document.body.removeChild(modal);
                });
                
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        document.body.removeChild(modal);
                    }
                });
            }

            // Global functions for pending review actions
            window.acceptPendingReview = function(index) {
                const review = pendingReviewsData[index];
                console.log('Accepting pending review:', review.review_title);
                
                // Move to accepted reviews
                acceptedReviewsData.push(review);
                pendingReviewsData.splice(index, 1);
                
                // Reset current index if needed
                if (currentPendingIndex >= pendingReviewsData.length) {
                    currentPendingIndex = Math.max(0, pendingReviewsData.length - 1);
                }
                
                // Show success modal then re-render
                document.getElementById('accept-modal').classList.add('is-visible');
            };

            window.rejectPendingReview = function(index) {
                const review = pendingReviewsData[index];
                console.log('Rejecting pending review:', review.review_title);
                document.getElementById('reject-modal').classList.add('is-visible');
            };

            window.editPendingReview = function(index) {
                const review = pendingReviewsData[index];
                currentEditingIndex = index;
                
                // Show current review content
                const currentReviewContent = document.getElementById('current-review-content');
                currentReviewContent.innerHTML = `
                    <strong>${review.review_title}</strong> (${review.actual_word_count} words)<br><br>
                    ${review.review_text}
                `;
                
                document.getElementById('edit-modal').classList.add('is-visible');
            };

            // Modal handlers
            const modals = {
                accept: document.getElementById('accept-modal'),
                reject: document.getElementById('reject-modal'),
                rejectSuccess: document.getElementById('reject-success-modal'),
                edit: document.getElementById('edit-modal'),
                editSuccess: document.getElementById('edit-success-modal')
            };

            // Accept modal handlers
            document.getElementById('accept-modal-close-btn').addEventListener('click', () => {
                modals.accept.classList.remove('is-visible');
                renderPendingReviews(); // Re-render to show updated state
            });

            modals.accept.addEventListener('click', (e) => {
                if (e.target === modals.accept) {
                    modals.accept.classList.remove('is-visible');
                    renderPendingReviews();
                }
            });

            // Reject modal handlers
            document.getElementById('reject-modal-close-btn').addEventListener('click', () => {
                modals.reject.classList.remove('is-visible');
            });

            modals.reject.addEventListener('click', (e) => {
                if (e.target === modals.reject) {
                    modals.reject.classList.remove('is-visible');
                }
            });

            // Reject success modal handlers
            document.getElementById('reject-success-modal-close-btn').addEventListener('click', () => {
                modals.rejectSuccess.classList.remove('is-visible');
                renderPendingReviews(); // Re-render to show updated state
            });

            modals.rejectSuccess.addEventListener('click', (e) => {
                if (e.target === modals.rejectSuccess) {
                    modals.rejectSuccess.classList.remove('is-visible');
                    renderPendingReviews();
                }
            });

            // Reject form submission
            document.getElementById('reject-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const reason = document.getElementById('reject-reason').value.trim();
                
                if (reason) {
                    console.log('Rejection reason:', reason);
                    
                    // Remove the rejected review
                    pendingReviewsData.splice(currentPendingIndex, 1);
                    
                    // Reset current index if needed
                    if (currentPendingIndex >= pendingReviewsData.length) {
                        currentPendingIndex = Math.max(0, pendingReviewsData.length - 1);
                    }
                    
                    modals.reject.classList.remove('is-visible');
                    modals.rejectSuccess.classList.add('is-visible');
                    document.getElementById('reject-form').reset();
                }
            });

            // Edit modal handlers
            document.getElementById('edit-modal-close-btn').addEventListener('click', closeEditModal);
            document.getElementById('cancel-edit-btn').addEventListener('click', closeEditModal);
            modals.edit.addEventListener('click', (e) => {
                if (e.target === modals.edit) closeEditModal();
            });

            function closeEditModal() {
                modals.edit.classList.remove('is-visible');
                currentEditingIndex = -1;
                document.getElementById('edit-form').reset();
                document.getElementById('selected-word-count').value = '100';
                document.querySelectorAll('.word-count-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector('.word-count-btn[data-count="100"]').classList.add('active');
            }

            // Edit success modal handlers
            document.getElementById('edit-success-modal-close-btn').addEventListener('click', closeEditSuccessModal);
            modals.editSuccess.addEventListener('click', (e) => {
                if (e.target === modals.editSuccess) closeEditSuccessModal();
            });

            function closeEditSuccessModal() {
                modals.editSuccess.classList.remove('is-visible');
                updatedReviewData = null;
            }

            // Word count button functionality
            document.querySelectorAll('.word-count-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.word-count-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    document.getElementById('selected-word-count').value = btn.dataset.count;
                });
            });

            // Edit form submission
            document.getElementById('edit-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const wordCount = document.getElementById('selected-word-count').value;
                const toneAdjustment = document.getElementById('tone-adjustment').value.trim();
                
                if (!toneAdjustment) {
                    alert('Please provide a tone adjustment instruction.');
                    return;
                }

                // Show animation
                const currentReviewPreview = document.getElementById('current-review-preview');
                const reviewContent = document.getElementById('current-review-content');
                const editingAnimation = document.getElementById('editing-animation');
                const progressFill = document.getElementById('progress-fill');
                const generateEditBtn = document.getElementById('generate-edit-btn');
                const generateBtnText = document.getElementById('generate-btn-text');
                
                // Start animation
                currentReviewPreview.classList.add('editing');
                reviewContent.classList.add('fade-out');
                editingAnimation.classList.add('active');
                
                // Disable button
                generateEditBtn.disabled = true;
                generateBtnText.textContent = 'Generating...';
                
                // Animate progress bar over 2 seconds
                let progress = 0;
                const progressInterval = setInterval(() => {
                    progress += 2;
                    progressFill.style.width = progress + '%';
                    if (progress >= 100) {
                        clearInterval(progressInterval);
                    }
                }, 40);

                try {
                    // Simulate API call
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    // Mock updated review
                    const originalReview = pendingReviewsData[currentPendingIndex];
                    updatedReviewData = {
                        ...originalReview,
                        review_text: `This is a mock updated review with approximately ${wordCount} words. The tone has been adjusted based on: "${toneAdjustment}". ${originalReview.review_text.substring(50)}`,
                        review_title: originalReview.review_title + ' (Edited)',
                        actual_word_count: parseInt(wordCount),
                        target_word_count: parseInt(wordCount)
                    };
                    
                    document.getElementById('updated-review-content').innerHTML = `
                        <div class="preview-title">Updated Review (${updatedReviewData.actual_word_count} words):</div>
                        <strong>${updatedReviewData.review_title}</strong><br><br>
                        ${updatedReviewData.review_text}
                    `;
                    
                    // Reset animation state
                    currentReviewPreview.classList.remove('editing');
                    reviewContent.classList.remove('fade-out');
                    editingAnimation.classList.remove('active');
                    progressFill.style.width = '0%';
                    
                    closeEditModal();
                    modals.editSuccess.classList.add('is-visible');
                    
                } catch (error) {
                    alert('Error generating edited review. Please try again.');
                    console.error('Edit error:', error);
                    
                    // Reset animation state on error
                    currentReviewPreview.classList.remove('editing');
                    reviewContent.classList.remove('fade-out');
                    editingAnimation.classList.remove('active');
                    progressFill.style.width = '0%';
                } finally {
                    // Reset button state
                    generateEditBtn.disabled = false;
                    generateBtnText.textContent = 'Generate Edited Review';
                }
            });

            // Keep original button
            document.getElementById('keep-original-btn').addEventListener('click', () => {
                closeEditSuccessModal();
            });

            // Use updated version button
            document.getElementById('use-updated-btn').addEventListener('click', () => {
                if (updatedReviewData && currentEditingIndex >= 0) {
                    // Update the review data
                    pendingReviewsData[currentEditingIndex] = updatedReviewData;
                    
                    closeEditSuccessModal();
                    renderPendingReviews(); // Re-render to show updated content
                }
            });

            // Initialize with pending reviews
            renderPendingReviews();
        });
    </script>
</body>
</html>